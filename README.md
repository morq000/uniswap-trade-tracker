# Uniswap Copy Trader
## Описание
Бот на платформе node.js, получающий информацию о сделках на Uniswap v2 и v3 через сервис TheGraph для целевого кошелька (target) и копирующее сделки в соответствии с заданными настройками. Предусмотрена отправка уведомлений в Telegram с помощью телеграм-бота.
## Требования к окружению
Приложение должно быть запущено на компьютере/сервере, имеющем постоянный доступ в интернет, так как копируются только те сделки, которые произошли, когда бот запущен. Перерывы в работе могут оставить некоторые сделки незакрытыми (не будет зафиксирована продажа актива таргетом) и нужно будет закрыть их вручную в случае необходимости.
## Настройка окружения и установка зависимостей
Убедитесь, что установлены Node.js и npm (менеджер пакетов Node.js). Для проверки откройте командную строку/терминал и введите следующие команды:
```
node -v
npm -v
```
Если команды возвращают номера версий, значит, Node.js и npm установлены корректно. 
`Минимальная требуемая версия node: 22`

В противном случае, скачайте и установите последнюю версию Node.js с официального сайта: https://nodejs.org/.

### Установка зависимостей проекта

Установите необходимые зависимости, выполнив команду:
```
npm install
```
Эта команда установит все пакеты, указанные в файле package.json.

### Создание и заполнение файла .env
Файл `.env` используется для хранения конфиденциальных данных и настроек, таких как ключи API и другие секреты. Создайте в корневой директории проекта файл `.env` и добавьте в него следующие строки:
```
PRIVATE_KEY=
INFURA_API_KEY=
GRAPH_API_TOKEN=
TELEGRAM_API_TOKEN=
TELEGRAM_CHAT_ID=
```
Заполните каждое поле соответствующими значениями. Ниже приведены инструкции по получению этих данных:

#### Получение PRIVATE_KEY

PRIVATE_KEY — это приватный ключ. Его можно экспортировать из кошелька (например, MetaMask). Обратите внимание, что приватный ключ должен храниться в секрете и не передаваться третьим лицам.

#### Получение INFURA_API_KEY

Infura предоставляет доступ к Ethereum и другим блокчейнам. Для получения API-ключа:

Зарегистрируйтесь на [Infura](https://www.infura.io/).
Создайте новый проект в панели управления.
В разделе настроек проекта вы найдете ваш INFURA_API_KEY.

#### Получение GRAPH_API_TOKEN

The Graph — это протокол для индексации данных из блокчейнов. Для получения токена:

Перейдите на [The Graph](https://thegraph.com/) и создайте аккаунт.
В настройках вашего аккаунта найдите раздел API Keys и создайте новый токен.

#### Получение TELEGRAM_API_TOKEN

Для создания Telegram-бота и получения API-токена:

Откройте Telegram и найдите бота `@BotFather`.
Начните диалог и отправьте команду `/newbot`.
Следуйте инструкциям для создания нового бота.
После создания бота вы получите TELEGRAM_API_TOKEN.

#### Получение TELEGRAM_CHAT_ID

TELEGRAM_CHAT_ID — это идентификатор чата, в который бот будет отправлять сообщения. Для его получения:

Добавьте созданного бота в нужный чат или создайте новый чат.
Отправьте сообщение боту в этом чате. После этого в браузере перейдите по ссылке `https://api.telegram.org/bot<YourBOTToken>/getUpdates`
В полученном ответе в разделе `chat: id:` находится нужный айди чата.

### Пользовательские настройки
Настройки находятся в файле `./user_config.json`. 
Пример настроек:
```
{
    "USER_CONFIG": {
        "TARGET_WALLET_ADDRESS": "<YOUR TARGET WALLET ADDRESS>",
        "MAX_DUPE_BUY": "3",
        "COPY_BUY_PERCENT": "10",
        "DEADLINE": "300",
        "PORTFOLIO_FILE_PATH": "./portfolio.json",
        "SLIPPAGE": "500",
        "ABORT_IF_STATS_FAIL": true
    }
}
```

Расшифровка:
- TARGET_WALLET_ADDRESS - адрес кошелька вашего таргета в сети Ethereum mainnet
- MAX_DUPE_BUY - максимальное количество повторных покупок ранее купленной монеты ("докупка")
- COPY_BUY_PERCENT - сколько процентов от размера оригинальной покупки таргета будет наша покупка (10 = покупаем на 10% от суммы таргета)
- DEADLINE - дедлайн транзакции в секундах (300 = 5 минут). Своп должен произойти не позже чем через указанное время после отправки.
- PORTFOLIO_FILE_PATH - местоположение файла, где будет храниться портфолио покупок и транзакций. Файл можно удалить для обнуления статистики и цепочек покупки/продажи.
- SLIPPAGE - проскальзывание, указанное число делится на 10_000. Например, 500 означает  (500 / 10000) = 0.05, или 5 процентов. 
- ABORT_IF_STATS_FAIL - экспериментальная настройка. Если установлена в true, nо покупка отменяется, если при обработки информации о токене произошли ошибки, при этом, сама покупка может быть выполнена успешно. Установка в False чревата получением неверной статистики.

### Запуск бота

Для запуска введите `npm run start` в терминале. В чате указанного телеграм-бота вы должны получить уведомление об успешном запуске. 